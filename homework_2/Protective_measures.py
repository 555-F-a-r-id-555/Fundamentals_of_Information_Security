"""Используя полученный в ходе выполнения файл XLSX/CSV-файла «Перечень сформированных угроз», 
сформируйте перечень уникальных "мер защиты", подсчитав вклад каждой меры в нейтрализацию соответствующего способа реализации угрозы (+1 балл). 
Отсортируйте полученный перечень по убыванию в части полученных баллов. 
написать обработчик CSV-файла на Python.
— код меры защиты
— наименование меры защиты
— количество баллов
— наименование меры на английском языке из CIS Controls (опционально)
— наименование меры на английском языке из NIST CSF (опционально).
"""

# pip install pandas openpyxl
import pandas as pd
from collections import Counter

# === Настройки ===
input_file = "./homework_2/List_of_generated_threats.csv"
output_csv = "./homework_2/Protective_measures_with_points_updated.csv"
output_excel = "./homework_2/Protective_measures_with_points_updated.xlsx"
encoding = "utf-8"

# === Шаг 1: Загрузка файла ===
df = pd.read_csv(input_file, encoding=encoding, sep=None, engine="python")

# === Шаг 2: Подсчёт уникальных мер защиты ===
measures_series = df["Меры защиты"].dropna()

all_measures = []
for entry in measures_series:
    parts = [measure.strip() for measure in entry.split(";\r\n") if measure.strip()]
    all_measures.extend(parts)

measure_counts = Counter(all_measures)

# === Шаг 3: Формирование DataFrame ===
measure_df = pd.DataFrame(measure_counts.items(), columns=["Полная мера", "Баллы"])
measure_df = measure_df.sort_values(by="Баллы", ascending=False).reset_index(drop=True)

# === Шаг 4: Разделение кода и наименования меры ===
measure_df["Код меры"] = measure_df["Полная мера"].apply(lambda x: x.split(" ")[0] if " " in x else "")
measure_df["Наименование меры защиты"] = measure_df["Полная мера"].apply(lambda x: " ".join(x.split(" ")[1:]) if " " in x else x)

# === Шаг 5: Добавление CIS и NIST Controls ===
mapping = {
    "Фильтрация сетевого трафика": 
    ("CIS Control 13.1: Ensure Network Infrastructure is Secure", "PR.PT-4"),
    "Семантический и статистический анализ сетевого трафика": 
    ("CIS Control 13.11: Deploy Application Layer Filtering", "PR.PT-4"),
    "Обеспечение доверенных канала": 
    ("CIS Control 13.9: Segment and Separate Networks", "PR.AC-5"),
    "Обеспечение подлинности сетевых соединений": 
    ("CIS Control 13.3: Securely Manage Network Infrastructure", "PR.AC-3"),
    "Блокирование устройства": 
    ("CIS Control 16.11: Quarantine or Remove Devices", "DE.CM-7"),
    "Ограничение доступа к информации": 
    ("CIS Control 4.4: Restrict Administrative Privileges", "PR.AC-4"),
    "Контроль действий пользователей": 
    ("CIS Control 5.1: Establish Secure Configurations", "PR.PT-1"),
    "Регистрация событий безопасности": 
    ("CIS Control 8.1: Enable Logging", "DE.AE-3"),
    "Антивирусная защита": 
    ("CIS Control 10.1: Deploy Anti-Malware Software", "PR.IP-1"),
    "Идентификация и аутентификация": 
    ("CIS Control 6.1: Establish a Process for Account Management", "PR.AC-1"),
    "Предоставление пользователям прав доступа к объектам доступа": (
        "CIS Control 4.5: Use Role-Based Access Control", "PR.AC-4"
    ),
    "Отключение неиспользуемых сетевых протоколов": (
        "CIS Control 11.4: Secure Network Protocols", "PR.IP-1"
    ),
    "Защита информации от раскрытия, модификации и навязывания": (
        "CIS Control 13.7: Use Encrypted Network Traffic", "PR.DS-2"
    ),
    "Разделение полномочий (ролей) пользователей": (
        "CIS Control 4.6: Separate Administrative Accounts", "PR.AC-5"
    ),
    "Реализация мандатного метода управления доступом": (
        "CIS Control 6.2: Establish and Maintain a Secure Access Model", "PR.AC-4"
    ),
    "Реализация ролевого метода управления доступом": (
        "CIS Control 4.5: Use Role-Based Access Control", "PR.AC-4"
    ),
    "Реализация дискреционного метода управления доступом": (
        "CIS Control 4.4: Restrict Administrative Privileges", "PR.AC-4"
    ),
    "Выявление (поиск) уязвимостей, связанных с ошибками кода": (
        "CIS Control 7.1: Establish and Maintain a Vulnerability Management Process", "DE.CM-8"
    ),
    "Многофакторная (двухфакторная) аутентификация пользователей": (
        "CIS Control 16.3: Implement Multi-Factor Authentication", "PR.AC-1"
    ),
    "Определение типов прикладного программного обеспечения, к которым разрешен доступ авторизованным (уполномоченным) пользователям из внешних информационных систем": (
        "CIS Control 12.1: Ensure Use of Only Fully Supported Browsers and Email Clients", "PR.AC-3"
    ),
    "Предоставление доступа только авторизованным (уполномоченным) пользователям": (
        "CIS Control 4.5: Use Role-Based Access Control", "PR.AC-4"
    ),
    "Обеспечение изоляции потоков данных, передаваемых и обрабатываемых компонентами инфраструктуры и сетевых потоков вычислительной сети": (
        "CIS Control 13.1: Centralize Network Access Control", "PR.DS-4"
    ),
    "Контроль передачи служебных информационных сообщений, передаваемых в сетях, хостовой операционной системы, по составу, объёму и иным характеристикам": (
        "CIS Control 13.7: Use Encrypted Network Traffic", "PR.PT-4"
    ),
    "Пересмотр и, при необходимости, корректировка учетных записей пользователей с периодичностью, определяемой субъектом": (
        "CIS Control 16.6: Monitor for Unauthorized Accounts", "PR.AC-1"
    ),
    "Установление (в том числе документальное) видов доступа, разрешенных для удаленного доступа к объектам доступа": (
        "CIS Control 12.2: Ensure Only Necessary Ports and Protocols Are Running", "PR.AC-3"
    ),
    "Контроль удаленного доступа пользователей (процессов запускаемых от имени пользователей) к объектам доступа до начала информационного взаимодействия (передачи защищаемой информации)": (
        "CIS Control 12.6: Centralize Remote Access", "PR.AC-3"
    ),
    "Назначение прав и привилегий пользователям и запускаемым от их имени процессам, администраторам и лицам, обеспечивающим функционирование, минимально необходимых для выполнения ими своих должностных обязанностей (функций), и санкционирование доступа к объектам доступа в соответствии с минимально необходимыми правами и привилегиями": (
        "CIS Control 4.8: Define and Maintain Role-Based Access", "PR.AC-6"
    ),
    "Аутентификация сервера, являющегося источником ответов на запросы (сервер доменных имен или DNS-сервер) по определению сетевых адресов (IP-адресов) по сетевым именам (доменные имена)": (
        "CIS Control 9.2: Ensure Only Necessary DNS Servers Are Allowed", "PR.DS-4"
    ),
    "Аутентификация сервера, являющегося источником ответов на запросы (кэширующий DNS-сервер) по определению сетевых имен (доменных имен) по сетевым адресам (IP-адресам)": (
        "CIS Control 9.2: Ensure Only Necessary DNS Servers Are Allowed", "PR.DS-4"
    ),
    "Уничтожение временных учетных записей пользователей, предоставленных для однократного (ограниченного по времени) выполнения задач": (
        "CIS Control 16.5: Remove Unnecessary Accounts", "PR.AC-1"
    ),
    "Оповещение администратора, осуществляющего управление учетными записями пользователей, об изменении сведений о пользователях, их ролях, обязанностях, полномочиях, ограничениях": (
        "CIS Control 16.7: Alert on Account Changes", "PR.AC-5"
    ),
    "Регламентация и контроль использования гостевых (анонимных) и временных учетных записей пользователей, а также привилегированных учетных записей администраторов": (
        "CIS Control 16.1: Maintain an Inventory of Accounts", "PR.AC-1"
    ),
    "Заведение, активация, блокирование и уничтожение учетных записей пользователей": (
        "CIS Control 16.2: Change Default Passwords", "PR.AC-1"
    ),
    "Предоставление удаленного доступа только тем пользователям, которым он необходим для выполнения установленных должностных обязанностей (функций)": (
        "CIS Control 12.4: Use Secure Remote Access", "PR.AC-3"
    ),
    "Верификация пользователя (проверка личности пользователя, его должностных (функциональных) обязанностей) при заведении учетной записи пользователя": (
        "CIS Control 16.1: Maintain an Inventory of Accounts", "PR.AC-1"
    ),
    "Объединение учетных записей в группы (при необходимости)": (
        "CIS Control 16.4: Use Unique Accounts", "PR.AC-1"
    ),
    "Определение типа учетной записи (внутреннего пользователя, внешнего пользователя; системная, приложения; гостевая (анонимная), временная и (или) иные типы записей)": (
        "CIS Control 16.4: Use Unique Accounts", "PR.AC-1"
    ),
    "Информирование должностных лиц оператора (пользователей, администраторов, подразделения по защите информации) о результатах поиска уязвимостей и оценки достаточности реализованных мер защиты информации": (
        "CIS Control 8.2: Remediate Detected Vulnerabilities", "RS.CO-2"
    ),
    "Разработка по результатам выявления (поиска) уязвимостей отчетов с описанием выявленных уязвимостей и планом мероприятий по их устранению": (
        "CIS Control 8.2: Remediate Detected Vulnerabilities", "RS.CO-2"
    ),
    # АУД.2.3 Устранение выявленных уязвимостей, в том числе путем установки обновлений
    "Устранение выявленных уязвимостей": (
        "CIS Control 3.4: Deploy Automated Operating System Patch Management Tools", 
        "PR.IP-12"
    ),

    # УКФ.3.2 Установка ПО только от имени администратора
    "Установка (инсталляция) в информационной системе программного обеспечения и (или) его компонентов должна осуществляться только от имени администратора": (
        "CIS Control 4.6: Limit Access to Scripting Tools", 
        "PR.AC-4"
    ),

    # УПД.13.2 Ограничение удаленного доступа
    "Ограничение на использование удаленного доступа в соответствии с задачами (функциями), для решения которых такой доступ необходим, и предоставление удаленного доступа для каждого разрешенного вида удаленного доступа": (
        "CIS Control 13.5: Implement Remote Access Management", 
        "PR.AC-3"
    ),

    # ЗИС.12.1 Изоляция процессов в выделенной памяти
    "Изоляция процессов (выполнение программ) в выделенной области памяти": (
        "CIS Control 14.6: Protect Information through Access Control Lists", 
        "PR.AC-5"
    ),

    # УПД.6.1 Контроль неуспешных попыток входа
    "Регламентация и контроль количества неуспешных попыток входа": (
        "CIS Control 6.3: Require Multi-factor Authentication", 
        "PR.AC-7"
    ),

    # ЗИС.2.2 Управление сетевыми интерфейсами
    "Обеспечение взаимодействия информационной системы и (или) ее сегментов с иными информационными системами и сетями только через сетевые интерфейсы, которые обеспечивают управление (контроль) информационными потоками с использованием средств защиты": (
        "CIS Control 13.2: Secure Network Configuration", 
        "PR.PT-4"
    ),

    # УПД.10.1 Блокирование сеанса после бездействия
    "Блокирование сеанса доступа пользователя после установленного Субъектом времени его бездействия (неактивности) или по запросу пользователя": (
        "CIS Control 5.2: Disable Unnecessary Services", 
        "PR.AC-5"
    ),

    # ОПО.1.1 Получение обновлений из доверенного источника
    "Проведение поиска и получение обновлений программного обеспечения от доверенного источника": (
        "CIS Control 3.1: Establish and Maintain a Patch Management Process", 
        "PR.IP-12"
    ),

    # ОПО.2.1 Проверка целостности ПО
    "Проведение проверки целостности программного обеспечения путем сверки контрольных сумм, предоставляемых разработчиком": (
        "CIS Control 3.5: Deploy Automated Software Patch Management Tools", 
        "PR.DS-6"
    ),

    # ИНЦ.4.4 Обучение персонала
    "Проведение обучения персонала организации, включая сотрудников подразделения по защите информации, для повышения осведомленности в части обеспечения безопасности": (
        "CIS Control 17.1: Establish and Maintain a Security Awareness Program", 
        "PR.AT-1"
    ),

    # УПД.14.5 Порядок обработки данных во внешних системах
    "Определение порядка обработки, хранения и передачи информации с использованием внешних информационных систем": (
        "CIS Control 15.4: Control Data Transmission", 
        "PR.DS-2"
    ),

    # ОПС.2.5 Настройка параметров ПО для устранения уязвимостей
    "Определение и применение параметров настройки компонентов программного обеспечения, включая программные компоненты средств защиты информации, обеспечивающих реализацию мер защиты информации, а также устранение возможных уязвимостей информационной системы, приводящих к возникновению угроз безопасности информации": (
        "CIS Control 5.1: Establish Secure Configurations", 
        "PR.IP-1"
    ),

    # АВЗ.1.1 Применение антивирусной защиты
    "Применение средств антивирусной защиты на автоматизированных рабочих местах, серверах, периметральных средствах защиты информации (средствах межсетевого экранирования, прокси-серверах, почтовых шлюзах и других средствах защиты информации), мобильных": (
        "CIS Control 10.1: Deploy Anti-Malware Software", 
        "PR.IP-1"
    ),

    # АВЗ.1.5 Проверка файлов в реальном времени
    "Проверка в масштабе времени, близком к реальному, объектов (файлов) из внешних источников (съемных машинных носителей информации, сетевых подключений, в том числе к сетям общего пользования, и других внешних источников) при загрузке, открытии или исполнении таких файлов": (
        "CIS Control 10.4: Enable Anti-Exploitation Features", 
        "PR.IP-1"
    ),

    # АВЗ.2.1 Антивирусная защита на прокси и почтовых серверах
    "Применение средств антивирусной защиты на прокси-серверах, почтовых шлюза, почтовых серверах и иных точках доступа в информационную систему, подверженных внедрению (заражению) вредоносными компьютерными программами (вирусами) через съемные машинные носители информации или сетевые подключения, в том числе к сетям общего пользования (вложения электронной почты, веб- и другие сетевые сервисы)": (
        "CIS Control 10.2: Deploy Anti-Phishing Defenses", 
        "PR.IP-1"
    ),

    # АВЗ.3.1 Проверка архивных и исполняемых файлов
    "Проверку в масштабе времени, близком к реальному, объектов (файлов) архивных, исполняемых и зашифрованных при загрузке, открытии или исполнении таких файлов.": (
        "CIS Control 10.3: Deploy Anti-Ransomware Defenses", 
        "PR.IP-1"
    ),

    # УПД.14.3 Определение системных учетных записей
    "Определение системных учетных записей": (
        "CIS Control 4.3: Use Dedicated Administrative Accounts", 
        "PR.AC-1"
    ),

    # УПД.14.4 Порядок доступа из внешних систем
    "Определение порядка предоставления доступа авторизованными (уполномоченным) пользователями из внешних информационных систем": (
        "CIS Control 13.6: Manage Network Ports and Services", 
        "PR.AC-5"
    ),

    # УПД.8.1 Оповещение о предыдущем входе
    "Оповещение пользователя после успешного входа о дате и времени предыдущего входа от имени этого пользователя": (
        "CIS Control 6.4: Monitor Account Access", 
        "PR.AC-4"
    ),

    # ИНЦ.1.1 Сбор событий безопасности
    "Сбор и первичная обработка информации, поступающей от источников событий информационной безопасности": (
        "CIS Control 8.1: Enable Logging", 
        "DE.AE-3"
    ),

    # УПД.0.1 Разработка политик доступа
    "Разработка правил и процедур (политик) управления доступом": (
        "CIS Control 4.1: Maintain Inventory of Accounts", 
        "PR.AC-4"
    ),

    # ЗИС.3.1 Распределение средств защиты
    "Распределение средств защиты": (
        "CIS Control 13.7: Segment Networks Based on Sensitivity", 
        "PR.AC-5"
    ),

    # ИНЦ.1.2 Автоматический анализ событий
    "Автоматический анализ событий": (
        "CIS Control 8.2: Central Log Management", 
        "DE.CM-1"
    ),

    # ЗИС.20.1 Доверенные маршруты передачи данных
    "Обеспечение доверенных маршрутов передачи данных между администратором (пользователем) и средствами защиты информации (функциями безопасности средств защиты информации), определяемыми оператором": (
        "CIS Control 13.10: Encrypt Network Traffic", 
        "PR.DS-2"
    ),

    # ИНЦ.6.3 Контроль доступа к записям инцидентов
    "Обеспечение доступа к записям о компьютерных инцидентах и функциям управления механизмами выявления (регистрации) инцидентов только уполномоченным должностным лицам": (
        "CIS Control 8.5: Retain Event Logs", 
        "PR.PT-1"
    ),

    # ИНЦ.3.2 Анализ воздействия инцидента
    "Определение текущего и потенциального воздействия инцидента на организацию, идентификация затронутой инфраструктуры и определение соответствующего направления работы": (
        "CIS Control 19.1: Establish Incident Response Plan", 
        "RS.AN-1"
    ),

    # УПД.7.1 Оповещение пользователей о мерах защиты
    "Оповещение пользователей в виде сообщения («окна») при его входе (до процесса аутентификации) о том, что реализованы меры защиты информации, а также о том, что при работепользователем должны быть соблюдены установленные правила и ограничения на работу с информацией": (
        "CIS Control 17.2: Train Workforce on Recognizing Threats", 
        "PR.AT-3"
    ),

    # ИНЦ.3.1 Назначение группы расследования
    "Назначение должностного лица (группы расследования), имеющего навыки проведения подобных расследований": (
        "CIS Control 19.2: Assign Roles and Responsibilities", 
        "RS.CO-2"
    ),

    # ОДТ.7.1 Группировка узлов для обеспечения доступности
    "Выделение групп однотипных узлов, объединенных каналами передачи информации и рассматриваемых как единый программно\002технический ресурс, информационной системы в целом и (или) отдельных ее сегментов (серверов приложений, файловых серверов, серверов баз данных, средств защиты информации и иных сегментов) для обеспечения доступности информации, сервисов и механизмов защиты информации": (
        "CIS Control 13.8: Deploy Network-Based IDS/IPS", 
        "PR.PT-4"
    ),

    # ИНЦ.5.11 Аудит защищенности
    "Проведение аудита защищенности, тестирования на проникновение": (
        "CIS Control 20.1: Perform Penetration Testing", 
        "PR.IP-12"
    ),

    # ИНЦ.6.2 Защита средств выявления инцидентов
    "Обеспечение защиты средств выявления (регистрации) инцидентов и настроек механизмов выявления (регистрации) инцидентов": (
        "CIS Control 8.6: Protect Logs from Unauthorized Access", 
        "PR.PT-1"
    ),

    # ИНЦ.6.1 Регламентация правил защиты информации
    "Регламентация правил и процедур защиты информации о событиях безопасности": (
        "CIS Control 17.3: Establish Security Policies", 
        "PR.IP-12"
    ),

    # ИНЦ.5.5 Информирование о недопустимости утечек
    "Доведение до сотрудников информации о недопустимости несанкционированной передачи конфиденциальной информации за пределы организации и ответственности за нарушение установленных в организации правил": (
        "CIS Control 17.4: Train Workforce on Data Handling", 
        "PR.AT-4"
    ),

    # ИНЦ.5.1 Совершенствование политик
    "Совершенствование политик": (
        "CIS Control 17.5: Train Workforce on Incident Response", 
        "PR.IP-12"
    ),

    # ИНЦ.5.2 Дополнительное обучение сотрудников
    "Проведение дополнительного обучения сотрудников, ознакомление с правилами обращения с конфиденциальной информацией": (
        "CIS Control 17.6: Train Workforce on Secure Development", 
        "PR.AT-5"
    ),

    # ИНЦ.5.3 Разработка регламентов 72
    "Разработка соответствующих регламентов": (
        "CIS Control 17.7: Train Workforce on Secure Configuration", 
        "PR.IP-12"
    ),

    # ИНЦ.5.4 Информирование о конфиденциальности
    "Доведение до сотрудников информации о недопустимости несанкционированной передачи конфиденциальной информации за пределы организации и ответственности за нарушение установленных в организации правил": (
        "CIS Control 17.8: Train Workforce on Secure Authentication", 
        "PR.AT-4"
    ),

    # ИНЦ.5.10 Пересмотр прав доступа 74
    "Пересмотр и настройка минимальных прав доступа": (
        "CIS Control 4.7: Limit Access to Data", 
        "PR.AC-4"
    ),

    # ИНЦ.5.9 Модернизация компонентов 75
    "Модернизация или замена компонентов информационных систем": (
        "CIS Control 2.1: Maintain Inventory of Assets", 
        "PR.IP-12"
    ),

    # ИНЦ.5.8 Установка средств защиты
    "Установка средств защиты": (
        "CIS Control 12.1: Maintain Secure Configurations", 
        "PR.IP-1"
    ),

    # ИНЦ.5.7 Меры административного характера
    "Меры административного характера": (
        "CIS Control 17.9: Train Workforce on Secure Remote Access", 
        "PR.AT-4"
    ),

    # ИНЦ.5.6 Ограничение доступа к конфиденциальной информации 78
    "Ограничение доступа сотрудника к конфиденциальной информации": (
        "CIS Control 4.8: Limit Access to Sensitive Data", 
        "PR.AC-4"
    ),

    # ИНЦ.4.1 Переоценка угроз 79
    "Переоценка угроз безопасности информации, повлекших возникновение инцидента": (
        "CIS Control 19.3: Conduct Post-Incident Reviews", 
        "RS.IM-1"
    ),

    # ИНЦ.1.3 Ретроспективный анализ данных 80
    "Ретроспективный анализ данных и выявление не обнаруженных ранее компьютерных инцидентов": (
        "CIS Control 8.4: Correlate Event Logs", 
        "DE.CM-1"
    ),
        # Аутентификация DNS-сервера (разрешение имен в IP) 8
    "Аутентификация сервера, являющегося источником ответов на запросы (сервер доменных имен или DNS\002сервер) по определению сетевых адресов (IP-адресов) по сетевым именам (доменные имена)": (
        "CIS Control 9.4: Authenticate All DNS Requests", 
        "PR.DS-6"
    ),

    # Аутентификация кэширующего DNS-сервера (обратный DNS)
    " Аутентификация сервера, являющегося источником ответов на запросы (кэширующийDNS-сервер) по определению сетевых имен (доменных имен) по сетевым адресам (IP-адресам)": (
        "CIS Control 9.5: Deploy DNSSEC for All DNS Servers", 
        "PR.DS-8"
    ),
        # Информирование о компьютерных инцидентах 82
    "Определение механизмов оперативного информирования о компьютерных инцидентах": (
        "CIS Control 19.4: Establish Incident Reporting Process", 
        "RS.CO-3"
    ),

    # Назначение ответственного за информирование НКЦКИ 81
    "Определение механизмов оперативного информирования пользователями службы безопасности о фактах выявления компьютерного инцидента. Назначение ответственного лица за информирование НКЦКИ.": (
        "CIS Control 19.2: Assign Roles and Responsibilities", 
        "RS.CO-2"
    ),

    # Определение мер защиты для минимизации угроз 82
    "Определение в соответствии с выявленными угрозами безопасности инофрмации мер защиты информации для минимизации выявленных угроз, в случае повторения инцидента": (
        "CIS Control 19.5: Conduct Post-Incident Reviews", 
        "RS.IM-2"
    ),

    # Идентификация и аутентификация пользователей 83
    "Обеспечение однозначной идентификации и аутентификации пользователей для всех видов доступа, кроме тех видов доступа, которые определяются как действия, разрешенные до идентификации и аутентификации.": (
        "CIS Control 6.1: Establish Process for Account Management", 
        "PR.AC-1"
    ),

    # Мониторинг удаленного доступа 84
    "Мониторинг и контроль удаленного доступа на предмет выявления несанкционированного удаленного доступа к объектам доступа": (
        "CIS Control 13.5: Implement Remote Access Management", 
        "PR.AC-3"
    ),

    # Неотказуемость отправки 85
    "Определение объектов или типов информации, для которых требуется обеспечение неотказуемости отправки (например, сообщения электронной почты": (
        "CIS Control 15.5: Implement Digital Signatures", 
        "PR.DS-6"
    ),

    # Неотказуемость получения 86
    "Определение объектов или типов информации, для которых требуется обеспечение неотказуемости получения (сообщения электронной почты)": (
        "CIS Control 15.6: Implement Non-Repudiation Mechanisms", 
        "PR.DS-6"
    ),

    # Выдача средств аутентификации 87
    "Выдача средств аутентификации пользователям": (
        "CIS Control 6.2: Use Unique Authentication Credentials", 
        "PR.AC-1"
    ),

    # Контроль изменений в ИС 88
    "Контроль действий по внесению изменений в информационной системе": (
        "CIS Control 5.3: Establish Change Control Process", 
        "PR.IP-3"
    ),

    # Аутентификация одноразовыми паролями 89
    "Аутентификация пользователей с применением одноразовых паролей": (
        "CIS Control 6.3: Require Multi-factor Authentication", 
        "PR.AC-7"
    ),

    # Актуализация политик и регламентов 90
    " Актуализация необходимых политик, регламентов, инструкций": (
        "CIS Control 17.3: Establish Security Policies", 
        "PR.IP-12"
    ),

    # Анализ сетевого трафика для обнаружения атак 91
    "Применение систем анализа сетевого трафика, предназначенных для перехвата потоков данных и обнаружения признаков сложных, чаще всего целевых атак": (
        "CIS Control 13.12: Deploy Network Intrusion Detection", 
        "DE.CM-1"
    ),

    # Аутентификация аппаратными токенами 92
    "Аутентификация пользователей с применением аппаратных средств (токенов)": (
        "CIS Control 6.4: Implement Physical MFA Tokens", 
        "PR.AC-7"
    ),

    # Управление атрибутами безопасности 93
    "Поддержка (обновление, назначение, изменение) и сохранение атрибутов безопасности (меток безопасности), связанных с информацией в процессе ее хранения и обработки": (
        "CIS Control 14.7: Implement Data Classification", 
        "PR.DS-5"
    ),

    # Аутентификация логином/паролем 94
    "Аутентификация пользователей с применением логина и пароля": (
        "CIS Control 6.5: Implement Password Managers", 
        "PR.AC-1"
    ),

    # Ограничение параллельных сеансов 96
    "Ограничение числа параллельных сеансов доступа для каждой учетной записи пользователя": (
        "CIS Control 16.8: Limit Concurrent Sessions", 
        "PR.AC-7"
    ),

    # Проверка вводимых данных 97
    "Вводимые данные должны проверяться на наличие конструкций, которые могут быть интерпретированы программно-техническими средствами информационной системы как исполняемые команды": (
        "CIS Control 14.2: Implement Input Validation", 
        "PR.PT-3"
    ),

    # Контроль целостности ПО 98
    "Контроль целостности компонентов программного обеспечения (за исключением средств защиты информации), определяемого оператором исходя из возможности реализации угроз безопасности информации, по наличию имен (идентификаторов) компонентов программного обеспечения и (или) по контрольным суммам в процессе загрузки и (или) динамически в процессе работы информационной системы": (
        "CIS Control 3.5: Verify Software Integrity", 
        "PR.DS-6"
    ),

    # Настройка параметров установки ПО 99
    "Настройка параметров установки компонентов программного обеспечения, обеспечивающая исключение установки (если осуществимо) компонентов программного обеспечения, использование которых не требуется для реализации информационной технологии": (
        "CIS Control 2.3: Configure Secure Software Installation", 
        "PR.IP-1"
    ),

    # Контроль за установкой ПО 100
    "Контроль за установкой компонентов программного обеспечения (состав компонентов, параметры установки, конфигурация компонентов)": (
        "CIS Control 2.4: Maintain Software Installation Logs", 
        "PR.IP-3"
    ),

    # Обнаружение вторжений 101
    "Обнаружение (предотвращение) вторжений (компьютерных атак), направленных на преднамеренный несанкционированный доступ к информации, специальные воздействия на информацию (носители информации) в целях ее добывания, уничтожения, искажения и блокирования доступа к ней, с использованием систем обнаружения вторжений": (
        "CIS Control 13.12: Deploy Intrusion Detection Systems", 
        "DE.CM-1"
    ),

    # Конфигурация устанавливаемых компонентов 102
    "Конфигурация устанавливаемых компонентов программного обеспечения (в том числе конфигурации, предусматривающие включение в домен, или не включение в домен)": (
        "CIS Control 5.2: Implement Secure Configuration Standards", 
        "PR.IP-1"
    ),

    # Определение компонентов для установки 103
    "Определение компонентов программного обеспечения (состава и конфигурации), подлежащих установке после загрузки операционной системы": (
        "CIS Control 2.5: Define Post-Installation Components", 
        "PR.IP-1"
    ),

    # Ложные компоненты для обнаружения атак 104
    "Применение специально созданных (эмулированных) ложных компонентов информационной системы или создание ложных информационных систем, предназначенных для обнаружения, регистрации и анализа действий нарушителей в процессе реализации угроз безопасности информации": (
        "CIS Control 13.14: Deploy Deception Technologies", 
        "DE.CM-8"
    ),

    # Мониторинг электронной почты 105
    "Мониторинг и контроль использования сервисов электронной почты (в том числе с использованием web-интерфейса) при передаче информации на внешние адреса электронной почты для всего трафика электронной почты и для всех учетных записей сервисов электронной почты": (
        "CIS Control 15.3: Monitor Email Traffic", 
        "DE.CM-3"
    ),

    # Уведомления об обновлениях антивируса 106
    "Получение уведомлений о необходимости обновлений и непосредственном обновлении базы данных признаков вредоносных компьютерных программ (вирусов)": (
        "CIS Control 10.6: Automate Anti-Malware Updates", 
        "PR.IP-12"
    ),

    # Централизованное обновление ПО 107
    "Реализация технологии централизованного обновления программного обеспечения, предусматривающая однократную передачу обновлений на сервер для их последующего применения на всех элементах информационной системы": (
        "CIS Control 3.2: Use Centralized Patch Management", 
        "PR.IP-12"
    ),

    # Проверка обновлений на изолированном сегменте 108
    "Проверка обновлений на изолированном сегменте": (
        "CIS Control 3.3: Test Patches Before Deployment", 
        "PR.IP-12"
    ),

    # Разные антивирусы на разных уровнях 108
    "Проведение проверки обновлений программного обеспечения на изолированном от основной информационной системы сегменте": (
        "CIS Control 10.7: Use Layered Anti-Malware Solutions", 
        "PR.IP-1"
    ),

    # Белый и черный списки ПО 109
    "Реализация на разных уровнях информационной системы средств антивирусной защиты разных производителей": (
        "CIS Control 2.6: Implement Application Whitelisting", 
        "PR.IP-1"
    ),
       # Разработка белых и черных списков ПО 110
    "Разработка перечня программного обеспечения и (или) его компонентов, разрешенных оператором к установке («белый список»), и (или) перечнем программного обеспечения и (или) его компонентов, запрещенных оператором к установке («черный список»)": (
        "CIS Control 2.3: Address Unauthorized Software", 
        "PR.IP-1"
    ),
    
    # Контроль целостности антивирусных баз
    "Контроль целостности обновлений базы данных признаков вредоносных компьютерных программ (вирусов)": (
        "CIS Control 10.5: Manage Anti-Malware Updates", 
        "PR.DS-6"
    ),
    
    # Периодический контроль установленного ПО
    "Проведение периодического контроля установленного (инсталлированного) в информационной системе программного обеспечения на предмет соответствия его перечню программного обеспечения, разрешенному к установке в информационной системе, а также на предмет отсутствия программного обеспечения, запрещенного оператором к установке": (
        "CIS Control 2.4: Utilize Application Allowlisting", 
        "PR.IP-1"
    ),
    
    # Обновление антивирусных баз
    "Получение из доверенных источников и установка обновлений базы данных признаков вредоносных компьютерных программ (вирусов)": (
        "CIS Control 10.4: Use Anti-Malware Software", 
        "PR.DS-6"
    ),
    
    # Взаимная аутентификация
    "Использование протоколов аутентификации, обеспечивающих взаимную аутентификацию пользователей": (
        "CIS Control 6.5: Require MFA for Remote Access", 
        "PR.AC-1"
    ),
    
    # Политика реагирования на инциденты
    "Разработка правил и процедур (политик) реагирования на компьютерные инциденты": (
        "CIS Control 17.1: Design Incident Response Plan", 
        "RS.RP-1"
    ),
    
    # Контроль загрузки ОС
    "Контроль доступа пользователей к процессу загрузки операционной системы": (
        "CIS Control 5.1: Establish Secure Configurations", 
        "PR.AC-1"
    ),
    
    # Тестирование средств защиты
    "Тестирование с периодичностью, установленной оператором, функций безопасности средств защиты информации, в том числе, с помощью тестирующих программ, имитирующих попытки несанкционированного доступа, и (или) специальных программных средств": (
        "CIS Control 18.10: Conduct Red Team Exercises", 
        "PR.IP-8"
    ),
    
    # Контроль средств разработки
    "Контроль применения средств разработки и отладки программ в составе программного обеспечения информационной системы": (
        "CIS Control 16.13: Log Application Errors", 
        "PR.IP-1"
    ),
    
    # Контроль целостности ПО СЗИ
    "Контроль целостности программного обеспечения средств защиты информации, включая их обновления, по наличию имен (идентификаторов) и (или) по контрольным суммам компонентов средств защиты информации в процессе загрузки и (или) динамически в процессе работы информационной системы": (
        "CIS Control 2.7: Use File Integrity Monitoring", 
        "PR.DS-6"
    ),
    
    # Управление интерфейсами ввода/вывода
    "Определение оператором интерфейсов средств вычислительной техники, которые могут использоваться для ввода (вывода) информации, разрешенных и (или) запрещенных к использованию в информационной системе": (
        "CIS Control 9.1: Restrict Use of Removable Media", 
        "PR.PT-2"
    ),
    
    # Фильтрация сайтов
    "Ограничение доступа к сайтам или типам сайтов, запрещенных к использованию": (
        "CIS Control 13.10: Enforce URL Filtering", 
        "PR.PT-4"
    ),
    
    # Защита от спама
    "Обнаружение и реагирование на поступление незапрашиваемых электронных сообщений (писем, документов) и иной информации, не относящихся к функционированию информационной системы (защита от спама)": (
        "CIS Control 10.2: Use Anti-Phishing Tools", 
        "DE.CM-7"
    ),
    
    # Контроль почтового обмена
    "Реализация электронного почтового обмена с внешними сетями через ограниченное количество контролируемых точек": (
        "CIS Control 13.5: Secure Email and Web Browsers", 
        "PR.PT-4"
    ),
    
    # Оценка изменений конфигурации
    "Оценка возможных последствий от внесения изменений в конфигурацию": (
        "CIS Control 4.1: Establish Security Awareness Program", 
        "ID.GV-2"
    ),
    
    # Децептивные технологии
    "Воспроизведение ложных и (или) скрытие истинных отдельных информационных технологий и (или) структурно-функциональных характеристик информационной системы или ее сегментов, обеспечивающее навязывание у нарушителя ложного представления об истинных информационных технологиях и (или) структурно-функциональных характеристиках информационной системы": (
        "CIS Control 14.6: Deploy Deception Tools", 
        "PR.IP-1"
    ),
    
    # Идентификация сетевых подключений
    "Идентификация сетевых подключений информационной системы к внешним информационным системам и сетям": (
        "CIS Control 12.1: Ensure Network Infrastructure Integrity", 
        "ID.AM-3"
    ),
    
    # Управление конфигурацией
    "Разработка правил и процедур (политик) управления конфигурацией информационной (автоматизированной) системы": (
        "CIS Control 4.3: Secure Configuration Management", 
        "PR.IP-1"
    ),
    
    # Ограничение прав ввода
    "Ограничение прав пользователей по вводу информации в информационную систему (ограничение по вводу в определенные типы объектов доступа (объекты файловой системы, объекты баз данных, объекты прикладного и специального программного обеспечения) информации исходя из задач и полномочий, решаемых пользователем в информационной системе)": (
        "CIS Control 4.4: Restrict Administrative Privileges", 
        "PR.AC-3"
    ),
    
    # Выявление скрытых каналов
    "Выявление и анализ скрытых каналов передачи информации для определения параметров передачи информации, которые могут использоваться для скрытого хранения информации и скрытой передачи информации за пределы информационной системы": (
        "CIS Control 13.8: Implement Application Layer Filtering", 
        "DE.CM-1"
    ),
    
    # Логирование передачи данных 130
    "Регистрация событий, связанных с получением информации от другого пользователя": (
        "CIS Control 8.2: Collect Audit Logs", 
        "DE.AE-3"
    ),
    # 131
    "Регистрация событий, связанных с отправкой информации другому пользователю": (
        "CIS Control 8.2: Enable Logging on All Systems", "DE.CM-7"
    ),
    "Организация защиты аутентификационной информации криптографическими методами шифрования трафика. Осуществление контроля целостности передаваемой аутентификационной информации. Организация защищенной передачи данных с использованием идентификаторов. Реализация методов динамической аутентификации.": (
        "CIS Control 13.7: Use Encrypted Network Traffic", "PR.DS-2"
    ),
    "Обеспечение физической защиты технических средств информационной системы": (
        "CIS Control 14.1: Establish and Maintain a Security Awareness Program", "PR.PT-1"
    ),
    "Идентификация сетевых подключений внешних информационных систем и сетей к информационной системе": (
        "CIS Control 12.1: Establish and Maintain an Inventory of Network Boundaries", "ID.AM-2"
    ),
    "Предотвращение повторного использования идентификатора пользователя и (или) устройства в течение установленного оператором периода времени": (
        "CIS Control 6.7: Enforce Password History", "PR.AC-1"
    ),
    "Определение должностного лица (администратора) оператора, ответственного за хранение, выдачу, инициализацию, блокирование средств аутентификации и принятие мер в случае утраты и (или) компрометации средств аутентификации": (
        "CIS Control 5.2: Establish and Maintain an Inventory of Service Accounts", "PR.AC-1"
    ),
    "Установление характеристик пароля устойчивых к перебору (использование нескольких алфавитов, специальных символов, регистра)": (
        "CIS Control 5.1: Establish and Maintain an Inventory of Accounts", "PR.AC-1"
    ),
    "Блокирование (прекращение действия) и замена утерянных, скомпрометированных или поврежденных средств аутентификации": (
        "CIS Control 5.3: Disable Dormant Accounts", "PR.AC-1"
    ),
    "Формирование идентификатора, который однозначно идентифицирует пользователя и (или) устройство и присвоение идентификатора пользователю и (или) устройству": (
        "CIS Control 5.4: Enforce Unique Passwords", "PR.AC-1"
    ),
    "Обновление аутентификационной информации (замена средств аутентификации) с периодичностью, установленной оператором": (
        "CIS Control 5.5: Enforce Password Complexity", "PR.AC-1"
    ),
    "Защита аутентификационной информации от неправомерного доступа к ней и модификации": (
        "CIS Control 5.6: Use Multi-Factor Authentication for All Administrative Access", "PR.AC-1"
    ),
    "Определение должностного лица (администратора) оператора, ответственного за создание, присвоение и уничтожение идентификаторов пользователей и устройств": (
        "CIS Control 5.7: Use Multi-Factor Authentication for All Remote Access", "PR.AC-1"
    ),
    "Аутентификация устройств с использованием соответствующих протоколов аутентификации или с применением криптографических методов защиты информации": (
        "CIS Control 6.1: Establish and Maintain an Inventory of Authentication Systems", "PR.AC-1"
    ),
    "Определение перечня типов устройств, подлежащих аутентификации по логическим именам (имя устройства и (или) ID), логическим адресам (например, IP-адресам) и (или) по физическим адресам (например, MAC-адресам) устройства или по комбинации имени, логического и (или) физического адресов устройства": (
        "CIS Control 6.2: Establish and Maintain an Inventory of Authentication Systems", "PR.AC-1"
    ),
    "Аутентификация пользователей с применением биометрии": (
        "CIS Control 6.3: Require MFA for Externally-Exposed Applications", "PR.AC-1"
    ),
    "Разработка правил и процедур (политик) идентификации и аутентификации субъектов доступа и объектов доступа. Реализуется путём выполнения положений внутренних документов.": (
        "CIS Control 6.4: Require MFA for Remote Network Access", "PR.AC-1"
    ),
    "Исключение возможности использования запрещенного мобильного кода в информационной системе, а также внедрение мобильного кода в местах, не разрешенных для его установки": (
        "CIS Control 7.1: Establish and Maintain a Vulnerability Management Process", "PR.IP-1"
    ),
    "Регистрация и анализ событий, связанных с разработкой, приобретением или внедрением технологии мобильного кода": (
        "CIS Control 7.2: Establish and Maintain a Vulnerability Management Process", "PR.IP-1"
    ),
    "Определение разрешенных мест распространения (серверы информационной системы) и использования мобильного кода (автоматизированные рабочие места, мобильные технические средства информационной системы) и функций информационной системы, для которых необходимо применение технологии мобильного кода": (
        "CIS Control 7.3: Establish and Maintain a Vulnerability Management Process", "PR.IP-1"
    ),
    "Определение перечня мобильного кода и технологий мобильного кода разрешенных и (или) запрещенных для использования в информационной системе": (
        "CIS Control 7.4: Establish and Maintain a Vulnerability Management Process", "PR.IP-1"
    ),
    #151
    "Блокирование идентификатора пользователя после установленного оператором времени неиспользования": (
        "CIS Control 5.8: Enforce Password Expiration", "PR.AC-1"
    ),
     # Проверка корректности и полноты вводимых данных 152
    "Контроль точности, полноты и правильности данных, вводимых в информационную систему, обеспечивается путем установления и проверки соблюдения форматов ввода данных, синтаксических, семантических и (или) иных правил ввода информации в информационную систему": (
        "CIS Control 10.4: Validate Input Data", "PR.DS-6"
    ),

    # Мониторинг возможных утечек на внешних ресурсах
    "Мониторинг содержания указанных выше ресурсов сети Интернет с целью возможной публикации информации конфиденциального характера": (
        "CIS Control 15.3: Monitor External Data Exposure", "DE.CM-4"
    ),

    # Определение критичных внешних источников
    "Определение перечня ресурсов сети Интернет, на которых высока вероятность публикации информации конфиденциального характера": (
        "CIS Control 15.1: Establish and Maintain an Inventory of Sensitive Data", "ID.RA-3"
    ),

    # Контроль состава ТС, ПО и СЗИ и сверка с документацией
    "Контроль состава технических средств, программного обеспечения и средств защиты информации на соответствие сведениям действующей (актуализированной) эксплуатационной документации и принятие мер, направленных на устранение выявленных недостатков": (
        "CIS Control 1.4: Address Unauthorized Assets", "PR.IP-1"
    ),

    # Контроль осведомленности персонала
    "Контроль осведомленности персонала об угрозах безопасности информации и о правилах безопасной работы": (
        "CIS Control 14.2: Train Workforce on Secure Behaviors", "PR.AT-1"
    ),

    # Реагирование на сбои в логировании
    "Реагирование на сбои при регистрации событий безопасности путем изменения администраторами параметров сбора, записи и хранения информации о событиях безопасности, в том числе отключение записи информации о событиях безопасности от части компонентов информационной системы, запись поверх устаревших хранимых записей событий безопасности": (
        "CIS Control 8.6: Centralize Security Log Management", "DE.AE-5"
    ),

    # Установление порогов надёжности и доступности
    "Определение предельных (пороговых) значений характеристик (коэффициента) готовности, показывающего, какую долю времени от общего времени работы информационной системы техническое средство (техническое решение) находится в рабочем состоянии, и характеристик надежности (требуемое значение вероятности отказа в единицу времени)": (
        "CIS Control 11.2: Establish and Maintain a Resilient Infrastructure", "PR.IP-9"
    ),

    # Сигнализация администратору о сбоях в логировании
    "Предупреждение (сигнализация, индикация) администраторов о сбоях (аппаратных и программных ошибках, сбоях в механизмах сбора информации или переполнения объема (емкости) памяти) при регистрации событий безопасности": (
        "CIS Control 8.7: Collect Detailed Audit Logs", "DE.AE-1"
    ),

    # Планирование реагирования на инциденты
    "Планирование и проведение мероприятий по реагированию на выявленные инциденты безопасности": (
        "CIS Control 17.1: Designate Personnel to Manage Incident Handling", "RS.RP-1"
    ),

    # Резервное копирование информации и ИТ-инфраструктуры
    "Резервирование информации и технических средств, программного обеспечения, каналов передачи информации": (
        "CIS Control 11.4: Implement Data Recovery Capabilities", "PR.IP-4"
    ),

    # Обеспечение контролируемой зоны 162
    "Обеспечение контролируемой зоны, в пределах которой постоянно размещаются стационарные технические средства, обрабатывающие информацию, и средства защиты информации, а также средства обеспечения функционирования": (
        "CIS Control 14.5: Protect Information at Physical Locations", "PR.PT-2"
    ),

    # Мониторинг журналов аудита 163
    "Мониторинг (просмотр и анализ) записей регистрации (аудита) должен проводиться для всех событий, подлежащих регистрации, и с периодичностью, установленной оператором, и обеспечивающей своевременное выявление признаков инцидентов безопасности в информационной системе": (
        "CIS Control 8.7: Collect Detailed Audit Logs", "DE.AE-3"
    ),

    # Использование ТС с нужными показателями надёжности
    "Применение в информационной системе технических средств с установленными оператором характеристиками (коэффициентом) готовности и надежности, обеспечивающих требуемые условия непрерывности функционирования информационной системы и доступности информации": (
        "CIS Control 11.2: Establish and Maintain a Resilient Infrastructure", "PR.IP-9"
    ),

    # Контроль за показателями надёжности и реагирование
    "Контроль с установленной оператором периодичностью за значениями характеристик (коэффициентов) готовности и надежности технических средств и реагирование на ухудшение значений данных характеристик (инициализация плана восстановления работоспособности и иные методы реагирования)": (
        "CIS Control 11.4: Implement Data Recovery Capabilities", "RS.CO-2"
    ),

    # Уведомление пользователя об ошибках
    "Генерирование сообщений для пользователей об их ошибочных действиях и о возможности нарушения безопасности информации в информационной системе для корректировки действий пользователей": (
        "CIS Control 16.5: Manage User Error Messages", "PR.DS-8"
    ),

    # Определение типов опасных пользовательских ошибок
    "Определение оператором типов ошибочных действий пользователей, которые потенциально могут привести к нарушению безопасности информации в информационной системе": (
        "CIS Control 16.6: Implement Security Awareness for User Behavior", "ID.RA-1"
    ),

    # Контроль целостности БД по контрольным суммам и структуре
    "Контроль целостности с периодичностью, установленной оператором, структуры базы данных по наличию имен (идентификаторов) и (или) по контрольным суммам программных компонент базы данных в процессе загрузки и (или) динамически в процессе работы информационной системы": (
        "CIS Control 2.6: Address Unauthorized Software", "PR.DS-6"
    ),

    # Управление временными файлами
    "Управление временными файлами, в том числе запрет, разрешение, перенаправление записи, удаление временных файлов": (
        "CIS Control 3.3: Configure Automatic Session Locking", "PR.IP-1"
    ),

    # Ограничение запуска от имени администраторов
    "Ограничение запуска компонентов программного обеспечения от имени администраторов безопасности": (
        "CIS Control 4.8: Restrict Administrator Privileges", "PR.AC-4"
    ),

    # Практические занятия с персоналом
    "Проведение практических занятий с персоналом по правилам безопасной работы": (
        "CIS Control 14.4: Train Workforce on Data Handling", "PR.AT-2"
    ),

    # Контроль функционирования ТС и восстановление после отказов 172
    "Контроль безотказного функционирования технических средств, обнаружение и локализация отказов функционирования, принятие мер по восстановлению отказавших средств и их тестирования": (
        "CIS Control 11.2: Establish and Maintain a Resilient Infrastructure", "PR.MA-1"
    ),

    # Определение сегментов для отказоустойчивых ТС 173
    "Определение сегментов информационной системы, в которых должны применяться отказоустойчивые технические средства, обладающие свойствами сохранять свою работоспособность после отказа одного или нескольких их составных частей, и перечня таких средств исходя из требуемых условий обеспечения непрерывности функционирования информационной системы и доступности информации, установленных оператором": (
        "CIS Control 11.2: Establish and Maintain a Resilient Infrastructure", "PR.IP-9"
    ),

    # Разрешение запуска ПО из автозагрузки
    "Разрешение запуска компонентов программного обеспечения, включенных в перечень (список) программного обеспечения, запускаемого автоматически при загрузке операционной системы средства вычислительной техники": (
        "CIS Control 2.3: Address Unauthorized Software", "PR.IP-1"
    ),

    # Обучение персонала правилам безопасной работы
    "Обучение персонала правилам безопасной работы": (
        "CIS Control 14.4: Train Workforce on Data Handling", "PR.AT-2"
    ),

    # Определение компонентов в автозагрузке
    "Определение перечня (списка) компонентов программного обеспечения (файлов, объектов баз данных, хранимых процедур и иных компонентов), запускаемых автоматически при загрузке операционной системы средства вычислительной техники": (
        "CIS Control 2.3: Address Unauthorized Software", "PR.IP-1"
    ),

    # Определение событий безопасности и сроков хранения
    "Определение событий безопасности в информационной системе, подлежащие регистрации, и сроки их хранения": (
        "CIS Control 8.2: Ensure Logging is Enabled and Active", "DE.AE-1"
    ),

    # Информирование персонала об угрозах
    "Информирование персонала об угрозах безопасности информации и о правилах безопасной работы": (
        "CIS Control 14.1: Establish and Maintain a Security Awareness Program", "PR.AT-1"
    ),

    # Контроль физического доступа
    "Контроль и управление физическим доступом к техническим средствам, средствам защиты информации, средствам обеспечения функционирования, а также в помещения и сооружения, в которых они установлены, исключающие несанкционированный физический доступ к средствам обработки информации, средствам защиты информации и средствам обеспечения функционирования информационной системы и помещения и сооружения, в которых они установлены": (
        "CIS Control 13.1: Maintain an Inventory of Physical Devices", "PR.AC-2"
    ),

    # Определение сегментов для резервирования
    "Определение сегментов информационной системы, в которых должно осуществляться резервирование технических средств, программного обеспечения, каналов передачи информации и средств обеспечения функционирования, а также перечня резервируемых средств исходя из требуемых условий обеспечения непрерывности функционирования информационной системы и доступности информации, установленных оператором": (
        "CIS Control 11.1: Establish and Maintain a Data Recovery Process", "PR.IP-9"
    ),

    # Активация резервных ресурсов
    "Ввод в действие резервного технического средства, программного обеспечения, канала передачи информации или средства обеспечения функционирования при нарушении требуемых условий непрерывности функционирования информационной системы и доступности информации": (
        "CIS Control 11.4: Implement Data Recovery Capabilities", "RS.MI-3"
    ),

    # Использование резервных решений для обеспечения непрерывности
    "Применение резервных (дублирующих) технических средств, программного обеспечения, каналов передачи информации и (или) средств обеспечения функционирования информационной системы, обеспечивающих требуемые условия непрерывности функционирования информационной системы и доступности информации": (
        "CIS Control 11.2: Establish and Maintain a Resilient Infrastructure", "PR.IP-9"
    ),

    # Защита архивов, конфигураций и ПО 183
    "Защита архивных файлов, параметров настройки средств защиты информации и программного обеспечения, иных данных, не подлежащих изменению в процессе обработки информации": (
        "CIS Control 3.7: Encrypt Sensitive Data at Rest", "PR.DS-1"
    ),
     # Загрузка ОС с носителей только для чтения 184
    "Загрузка и выполнение на средствах вычислительной техники, определяемых оператором, операционной системы с машинных носителей информации, доступных только для чтения": (
        "CIS Control 4.7: Restrict Use of Removable Media", "PR.IP-1"
    ),

    # Загрузка прикладного ПО с носителей только для чтения
    "Загрузка и выполнение на средствах вычислительной техники прикладного программного обеспечения, определяемого оператором, с машинных носителей информации, доступных только для чтения": (
        "CIS Control 2.6: Address Unauthorized Software", "PR.IP-1"
    ),

    # Резервное копирование с установленной периодичностью
    "Резервное копирование информации на резервные машинные носители информации с установленной оператором периодичностью": (
        "CIS Control 11.1: Establish and Maintain a Data Recovery Process", "PR.IP-4"
    ),

    # Защита резервируемой информации
    "Принятие мер для защиты резервируемой информации, обеспечивающих ее конфиденциальность, целостность и доступность": (
        "CIS Control 3.4: Protect Recovery Data", "PR.DS-4"
    ),

    # Мониторинг и контроль печати/копирования в защищённых сегментах
    "Мониторинг и контроль печати и (или) копирования информации на бумажных носителях для сегментов вычислительной сети организации, предназначенных для обработки и (или) хранения информации конфиденциального характера, и для всех учетных записей, используемых для осуществления печати информации": (
        "CIS Control 13.3: Securely Dispose of Data", "PR.DS-5"
    ),

    # Контроль входящих/исходящих информационных потоков
    "Управление (контроль) входящими в информационную систему и исходящими из информационной системы информационными потоками на физической и (или) логической границе информационной системы (сегментов информационной системы)": (
        "CIS Control 13.2: Implement Network Segmentation", "PR.AC-5"
    ),

    # Реагирование на заражения вредоносными программами
    "Определение и выполнение действий по реагированию на обнаружение в информационной системе объектов, подвергшихся заражению вредоносными компьютерными программами (вирусами)": (
        "CIS Control 10.6: Respond to Malware", "RS.RP-1"
    ),

    # Оповещение администраторов о вредоносных ПО
    "Оповещение администраторов безопасности в масштабе времени, близком к реальному, об обнаружении вредоносных компьютерных программ (вирусов)": (
        "CIS Control 10.2: Enable Automated Alerting", "DE.CM-1"
    ),

    # Периодические антивирусные проверки
    "Проведение периодических проверок компонентов информационной системы (автоматизированных рабочих мест, серверов, других средств вычислительной техники) на наличие вредоносных компьютерных программ (вирусов)": (
        "CIS Control 10.1: Deploy and Maintain Anti-Malware Software", "PR.IP-12"
    ),

    # Контроль физдоступа от визуального и слухового ознакомления
    "Контроль физического доступа с целью предотвращения визуального и слухового ознакомления с информацией во все помещения, в которых осуществляется обработка и (или) хранение информации конфиденциального характера": (
        "CIS Control 13.4: Restrict Physical Access", "PR.AC-2"
    ),

    # Контроль выноса всех СВТ
    "Контроль передачи (выноса) всех средств вычислительной техники независимо от осуществления обработки и (или) хранения информации конфиденциального характера": (
        "CIS Control 13.5: Manage Asset Inventory and Transport", "PR.AC-1"
    ),

    # Мониторинг действий внутренних нарушителей 195
    "Мониторинг и анализ всех действий возможных внутренних нарушителей, связанных с доступом к информационным активам конфиденциальной информации, согласно определенному перечню для всех учтенных информационных активов": (
        "CIS Control 8.6: Collect Detailed Audit Logs", "DE.AE-3"
    ),
    # Перечень действий внутренних нарушителей под мониторинг 196
    "Определение перечня действий возможных внутренних нарушителей, связанных с доступом к информационным активам конфиденциальной информации, подвергаемых мониторингу и анализу для цели выявления потенциальных утечек информации. При этом рекомендуется подвергать мониторингу и анализу": (
        "CIS Control 8.7: Review Audit Logs", "DE.AE-5"
    ),

    # Блокировка доступа к конф. информации вне ИИ
    "Блокирование возможности доступа к информации конфиденциального характера для всех средств вычислительной техники, используемых за пределами информационной инфраструктуры организации, вне зависимости от их использования для обработки и (или) хранения информации конфиденциального характера и всех информационных активов организации, к которым осуществляется удаленный доступ": (
        "CIS Control 12.3: Configure Trusted Network Zones", "PR.AC-3"
    ),

    # Блокировка доступа к конф. информации на носителях вне ИИ
    "Контроль (блокирование) возможности использования и (или) доступа к информации конфиденциального характера на переносных носителях информации за пределами информационной инфраструктуры организации для всех переносных носителей информации вне зависимости от их использования для обработки и (или) хранения информации конфиденциального характера": (
        "CIS Control 4.7: Restrict Use of Removable Media", "PR.DS-3"
    ),

    # Блокирование копирования на носители
    "Мониторинг, контроль, блокирование копирования информации на переносные носители информации для всех средств вычислительной техники, мобильных устройств": (
        "CIS Control 4.8: Log and Alert on Unauthorized Use of Removable Media", "PR.PT-2"
    ),

    # Мониторинг использования Интернета
    "Обеспечить мониторинг и контроль использования сети Интернет для всех средств вычислительной техники, расположенных в группах сегментов вычислительной сети организации, предназначенных для обработки и (или) хранения информации конфиденциального характера, и для всех учетных записей, используемых для осуществления доступа к сети Интернет": (
        "CIS Control 9.4: Apply Network-Based URL Filtering", "DE.CM-7"
    ),

    # Управление перемещением данных между хранилищами (виртуалки)
    "Управление размещением и перемещением данных, обрабатываемых с использованием виртуальных машин, между носителями (системами хранения данных)": (
        "CIS Control 11.4: Encrypt Data on End-User Devices and Removable Media", "PR.DS-2"
    ),

    # Запрет доступа к ресурсам при повторном использовании
    "Обеспечение запрета доступа текущему пользователю (учетной записи) или текущему процессу к системным ресурсам (реестрам, оперативной памяти, внешним запоминающим устройствам) при их повторном использовании, в которых хранится информация другого (предыдущего) пользователя": (
        "CIS Control 4.2: Configure Automatic Session Locking", "PR.DS-1"
    ),

    # Удаление несанкционированных ТС/ПО/СЗИ
    "Исключение (восстановление) из состава информационной системы несанкционированно установленных (удаленных) технических средств, программного обеспечения и средств защиты информации": (
        "CIS Control 2.6: Address Unauthorized Software", "PR.IP-1"
    ),

    # Повышение производительности каналов/оборудования 204
    "Повышение характеристик производительности телекоммуникационного оборудования и каналов передачи": (
        "CIS Control 13.6: Ensure Availability of Network Services", "PR.AC-4"
    ),

}

def map_controls(description):
    for key, (cis, nist) in mapping.items():
        if key.lower() in description.lower():
            return pd.Series([cis, nist])
    return pd.Series([None, None])

measure_df[["CIS Controls (англ.)", "NIST CSF (англ.)"]] = measure_df["Наименование меры защиты"].apply(map_controls)

# === Шаг 6: Финальный DataFrame и сохранение ===
final_df = measure_df[[
    "Код меры",
    "Наименование меры защиты",
    "Баллы",
    "CIS Controls (англ.)",
    "NIST CSF (англ.)"
]]

final_df.to_csv(output_csv, index=False, encoding="utf-8-sig")
final_df.to_excel(output_excel, index=False)

print("Файлы успешно сохранены:")
print(f"- CSV: {output_csv}")
print(f"- Excel: {output_excel}")



# # pip install openpyxl
# import pandas as pd
# from collections import Counter

# # === Настройки ===
# input_file = "./homework_2/List_of_generated_threats.csv"
# output_file = "./homework_2/Protective_measures_with_points.csv"
# output_file_v2 = "./homework_2/Protective_measures_with_points.xlsx"
# encoding = "utf-8"

# # === Загрузка файла ===
# df = pd.read_csv(input_file, encoding=encoding, sep=None, engine="python")

# # === Сбор всех мер защиты ===
# measures_series = df["Меры защиты"].dropna()
# all_measures = []
# for entry in measures_series:
#     parts = [measure.strip() for measure in entry.split(";\r\n") if measure.strip()]
#     all_measures.extend(parts)

# # === Подсчёт баллов ===
# measure_counts = Counter(all_measures)

# # === Формирование таблицы с разбиением ===
# rows = []
# for full_measure, points in measure_counts.items():
#     parts = full_measure.split(" ", 1)
#     if len(parts) == 2:
#         code, name = parts
#     else:
#         code, name = parts[0], ""
#     rows.append({
#         "Код меры защиты": code,
#         "Наименование меры защиты": name,
#         "Баллы": points,
#         "CIS Controls (англ.)": "",  # Нужно заполнить 
#         "NIST CSF (англ.)": ""        # Нужно заполнить 
#     })

# measure_df = pd.DataFrame(rows)
# measure_df = measure_df.sort_values(by="Баллы", ascending=False).reset_index(drop=True)

# # === Сохраняем результат ===
# measure_df.to_csv(output_file, index=False, encoding="utf-8-sig")
# measure_df.to_excel(output_file_v2, index=False)

# print(f"Готово! Файл сохранён как: {output_file}")
# print(f"Также Excel-файл сохранён как: {output_file_v2}")



